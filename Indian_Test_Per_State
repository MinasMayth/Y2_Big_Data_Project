import pandas as pd
import numpy as np

#reading the document
india_d_test = pd.read_csv(r'India.csv', error_bad_lines=False, infer_datetime_format=True, index_col=False )

#Removing the 'Other' Column from the document
keep_col = ['Date','State','District','Confirmed','Recovered',"Deceased","Tested"]
new_india_d_test = india_d_test [keep_col]

#Creating a new CSV files without the 'Other' column
new_india_d_test.to_csv("india_Test_Cleaned.csv", index=False)
CleanedData = pd.read_csv(r'india_Test_Cleaned.csv', error_bad_lines=False, infer_datetime_format=True)

#Dropping all the rows with a N/A value and creating a new csv file
Ind = CleanedData.dropna(axis = 0, how = 'any')
Ind.to_csv("FinalIndiaData", index=False)
FData = pd.read_csv(r'FinalIndiaData', error_bad_lines=False, infer_datetime_format=True,)

#Iterating through the 'Date' column to see which date is the most used

Dates = []
FData["Date"].value_counts().tolist()

for index,row in FData.iterrows():
  if row["Date"] not in Dates:
     #Dates.append(row ["Date"])

print(Dates)

for Date in Dates:
    #print(FData['Date'].value_counts())

#2021 - 02 - 11 is the most reccuring date

#Attempt to clean the csv file and obtain all the data for the needed date

for index,row in FData.iterrows():
    if row["Date"] != '2021-02-11':
        FData.drop(row.index,axis=0)
FData.to_csv(r"FinalDataIndia")







